Namespace(annpath='train.json', batch_size=1, bs=8, clip_len=64, cuda=True, dataparallel=True, emb_init='../wordvectors/glove.6B.300d.txt', embedding_size=512, feature_size=2048, framepath='frames', ft_begin_index=0, imsize=224, langmethod='Transformer', log_every=10, lr=0.0001, lstm_memory=512, lstm_pretrain_ep=0, lstm_stacks=1, manual_seed=1, max_epochs=1000, max_seqlen=30, meta_path='videometa_train.json', mode='train', model_ep=100, model_path='../models', modeldepth=101, modelname='resnext', momentum=0.9, n_classes=739, n_cpu=8, n_finetune_classes=739, norm_value=1, num_layers=18, patience=10, pretrain_path='../models/save_105.pth', resnet_shortcut='A', resnext_cardinality=32, root_path='/ssd1/dsets/activitynet_captions', start_from_ep=0, submission_path='submission.json', token_level=False, vocabpath='vocab_pad.json', weight_decay=0.0001, wide_resnet_k=2)
loaded dictionary from /ssd1/dsets/activitynet_captions/vocab_pad.json
dictionary length: 11182 words
loaded pretrain models from ../models/save_105.pth
using 4 gpus...
# of params in model : 98433984
start decoder pretraining, doing for 0 epochs
done with decoder pretraining
start training
elapsed: 48s | iter 000010/001133 | nll loss: 9.7793 | 4.8980s per loop
elapsed: 01m08s | iter 000020/001133 | nll loss: 9.2166 | 1.9864s per loop
elapsed: 01m26s | iter 000030/001133 | nll loss: 8.5764 | 1.7309s per loop
elapsed: 01m47s | iter 000040/001133 | nll loss: 8.4458 | 2.1316s per loop
elapsed: 02m12s | iter 000050/001133 | nll loss: 8.2219 | 2.4717s per loop
elapsed: 02m33s | iter 000060/001133 | nll loss: 7.9552 | 2.0889s per loop
elapsed: 02m55s | iter 000070/001133 | nll loss: 8.0025 | 2.2630s per loop
elapsed: 03m15s | iter 000080/001133 | nll loss: 7.7424 | 1.9909s per loop
elapsed: 03m35s | iter 000090/001133 | nll loss: 7.7308 | 1.9870s per loop
elapsed: 03m55s | iter 000100/001133 | nll loss: 7.7428 | 2.0485s per loop
elapsed: 04m19s | iter 000110/001133 | nll loss: 7.7866 | 2.3138s per loop
elapsed: 04m41s | iter 000120/001133 | nll loss: 7.6235 | 2.2103s per loop
elapsed: 05m01s | iter 000130/001133 | nll loss: 7.8850 | 2.0452s per loop
elapsed: 05m26s | iter 000140/001133 | nll loss: 7.9483 | 2.4671s per loop
elapsed: 05m51s | iter 000150/001133 | nll loss: 7.7619 | 2.5152s per loop
elapsed: 06m14s | iter 000160/001133 | nll loss: 7.9908 | 2.2994s per loop
elapsed: 06m33s | iter 000170/001133 | nll loss: 7.8879 | 1.9463s per loop
elapsed: 06m56s | iter 000180/001133 | nll loss: 7.5121 | 2.2961s per loop
elapsed: 07m21s | iter 000190/001133 | nll loss: 7.4524 | 2.4482s per loop
elapsed: 07m46s | iter 000200/001133 | nll loss: 7.4960 | 2.5169s per loop
elapsed: 08m11s | iter 000210/001133 | nll loss: 7.5484 | 2.4737s per loop
elapsed: 08m30s | iter 000220/001133 | nll loss: 7.7416 | 1.8859s per loop
elapsed: 08m52s | iter 000230/001133 | nll loss: 7.6564 | 2.2726s per loop
elapsed: 09m18s | iter 000240/001133 | nll loss: 7.6620 | 2.6097s per loop
elapsed: 09m40s | iter 000250/001133 | nll loss: 7.5846 | 2.2008s per loop
elapsed: 09m58s | iter 000260/001133 | nll loss: 7.6991 | 1.7700s per loop
elapsed: 10m22s | iter 000270/001133 | nll loss: 7.4849 | 2.4079s per loop
elapsed: 10m42s | iter 000280/001133 | nll loss: 7.5576 | 1.9819s per loop
elapsed: 11m03s | iter 000290/001133 | nll loss: 7.4689 | 2.1012s per loop
elapsed: 11m24s | iter 000300/001133 | nll loss: 7.5217 | 2.0875s per loop
elapsed: 11m44s | iter 000310/001133 | nll loss: 7.4330 | 2.0079s per loop
elapsed: 12m02s | iter 000320/001133 | nll loss: 7.5105 | 1.7632s per loop
elapsed: 12m21s | iter 000330/001133 | nll loss: 7.4011 | 1.9079s per loop
elapsed: 12m39s | iter 000340/001133 | nll loss: 7.3800 | 1.8154s per loop
elapsed: 12m59s | iter 000350/001133 | nll loss: 7.4955 | 1.9680s per loop
elapsed: 13m20s | iter 000360/001133 | nll loss: 7.6902 | 2.1156s per loop
elapsed: 13m44s | iter 000370/001133 | nll loss: 7.5864 | 2.4336s per loop
elapsed: 14m03s | iter 000380/001133 | nll loss: 7.5136 | 1.8700s per loop
elapsed: 14m23s | iter 000390/001133 | nll loss: 7.5653 | 2.0270s per loop
elapsed: 14m42s | iter 000400/001133 | nll loss: 7.7158 | 1.9371s per loop
elapsed: 15m01s | iter 000410/001133 | nll loss: 7.5234 | 1.8404s per loop
elapsed: 15m22s | iter 000420/001133 | nll loss: 7.7137 | 2.0816s per loop
elapsed: 15m46s | iter 000430/001133 | nll loss: 7.5143 | 2.4396s per loop
elapsed: 16m12s | iter 000440/001133 | nll loss: 7.3135 | 2.6355s per loop
elapsed: 16m37s | iter 000450/001133 | nll loss: 7.6021 | 2.4631s per loop
elapsed: 16m59s | iter 000460/001133 | nll loss: 7.6875 | 2.2345s per loop
elapsed: 17m21s | iter 000470/001133 | nll loss: 7.7011 | 2.1700s per loop
elapsed: 17m42s | iter 000480/001133 | nll loss: 7.5291 | 2.0594s per loop
elapsed: 18m04s | iter 000490/001133 | nll loss: 7.2914 | 2.2208s per loop
elapsed: 18m27s | iter 000500/001133 | nll loss: 7.4692 | 2.2824s per loop
elapsed: 18m47s | iter 000510/001133 | nll loss: 7.7477 | 2.0273s per loop
elapsed: 19m05s | iter 000520/001133 | nll loss: 7.5994 | 1.8420s per loop
elapsed: 19m30s | iter 000530/001133 | nll loss: 7.3456 | 2.4987s per loop
elapsed: 19m52s | iter 000540/001133 | nll loss: 7.4301 | 2.1412s per loop
elapsed: 20m15s | iter 000550/001133 | nll loss: 7.4157 | 2.2964s per loop
elapsed: 20m43s | iter 000560/001133 | nll loss: 7.3840 | 2.7767s per loop
elapsed: 21m09s | iter 000570/001133 | nll loss: 7.3060 | 2.6230s per loop
elapsed: 21m34s | iter 000580/001133 | nll loss: 7.3410 | 2.5511s per loop
elapsed: 21m55s | iter 000590/001133 | nll loss: 7.4112 | 2.0926s per loop
elapsed: 22m15s | iter 000600/001133 | nll loss: 7.6554 | 2.0123s per loop
elapsed: 22m33s | iter 000610/001133 | nll loss: 7.3027 | 1.7593s per loop
elapsed: 22m58s | iter 000620/001133 | nll loss: 7.5202 | 2.4966s per loop
elapsed: 23m16s | iter 000630/001133 | nll loss: 7.5459 | 1.8221s per loop
elapsed: 23m40s | iter 000640/001133 | nll loss: 7.2636 | 2.3400s per loop
elapsed: 23m58s | iter 000650/001133 | nll loss: 7.7240 | 1.8270s per loop
elapsed: 24m17s | iter 000660/001133 | nll loss: 7.5689 | 1.9530s per loop
elapsed: 24m39s | iter 000670/001133 | nll loss: 7.6129 | 2.1501s per loop
elapsed: 24m59s | iter 000680/001133 | nll loss: 7.2726 | 2.0491s per loop
elapsed: 25m17s | iter 000690/001133 | nll loss: 7.4370 | 1.7790s per loop
elapsed: 25m34s | iter 000700/001133 | nll loss: 7.5808 | 1.6497s per loop
elapsed: 25m53s | iter 000710/001133 | nll loss: 7.3457 | 1.9214s per loop
elapsed: 26m14s | iter 000720/001133 | nll loss: 7.3327 | 2.1052s per loop
elapsed: 26m31s | iter 000730/001133 | nll loss: 7.2140 | 1.6697s per loop
elapsed: 26m53s | iter 000740/001133 | nll loss: 7.7084 | 2.2304s per loop
elapsed: 27m11s | iter 000750/001133 | nll loss: 7.4857 | 1.8610s per loop
elapsed: 27m32s | iter 000760/001133 | nll loss: 7.0910 | 2.0212s per loop
elapsed: 27m54s | iter 000770/001133 | nll loss: 7.6155 | 2.1814s per loop
elapsed: 28m14s | iter 000780/001133 | nll loss: 7.3299 | 2.0181s per loop
elapsed: 28m34s | iter 000790/001133 | nll loss: 7.6356 | 2.0501s per loop
elapsed: 28m57s | iter 000800/001133 | nll loss: 7.5352 | 2.2670s per loop
elapsed: 29m18s | iter 000810/001133 | nll loss: 7.6364 | 2.0906s per loop
elapsed: 29m42s | iter 000820/001133 | nll loss: 7.3902 | 2.4039s per loop
elapsed: 30m03s | iter 000830/001133 | nll loss: 7.1448 | 2.0902s per loop
elapsed: 30m24s | iter 000840/001133 | nll loss: 7.4399 | 2.1349s per loop
elapsed: 30m45s | iter 000850/001133 | nll loss: 7.4683 | 2.0956s per loop
elapsed: 31m07s | iter 000860/001133 | nll loss: 7.6164 | 2.1948s per loop
elapsed: 31m28s | iter 000870/001133 | nll loss: 7.4824 | 2.1096s per loop
elapsed: 31m49s | iter 000880/001133 | nll loss: 7.3907 | 2.0460s per loop
elapsed: 32m12s | iter 000890/001133 | nll loss: 7.4197 | 2.3744s per loop
elapsed: 32m34s | iter 000900/001133 | nll loss: 7.6649 | 2.2074s per loop
elapsed: 32m57s | iter 000910/001133 | nll loss: 7.4566 | 2.2311s per loop
elapsed: 33m21s | iter 000920/001133 | nll loss: 7.2211 | 2.4066s per loop
elapsed: 33m46s | iter 000930/001133 | nll loss: 7.8662 | 2.5707s per loop
elapsed: 34m07s | iter 000940/001133 | nll loss: 7.0664 | 2.0758s per loop
elapsed: 34m30s | iter 000950/001133 | nll loss: 7.4230 | 2.3217s per loop
elapsed: 34m51s | iter 000960/001133 | nll loss: 7.2522 | 2.0317s per loop
elapsed: 35m13s | iter 000970/001133 | nll loss: 7.4972 | 2.2175s per loop
elapsed: 35m39s | iter 000980/001133 | nll loss: 7.4717 | 2.5650s per loop
elapsed: 36m05s | iter 000990/001133 | nll loss: 7.2949 | 2.6912s per loop
elapsed: 36m29s | iter 001000/001133 | nll loss: 7.3003 | 2.3256s per loop
elapsed: 36m52s | iter 001010/001133 | nll loss: 7.1879 | 2.3144s per loop
elapsed: 37m11s | iter 001020/001133 | nll loss: 7.2004 | 1.9584s per loop
elapsed: 37m36s | iter 001030/001133 | nll loss: 7.5725 | 2.4272s per loop
elapsed: 37m58s | iter 001040/001133 | nll loss: 7.4040 | 2.2183s per loop
elapsed: 38m23s | iter 001050/001133 | nll loss: 7.4022 | 2.5179s per loop
elapsed: 38m51s | iter 001060/001133 | nll loss: 7.3355 | 2.7701s per loop
elapsed: 39m14s | iter 001070/001133 | nll loss: 7.2955 | 2.3049s per loop
elapsed: 39m36s | iter 001080/001133 | nll loss: 7.3440 | 2.2537s per loop
elapsed: 39m56s | iter 001090/001133 | nll loss: 7.3498 | 1.9940s per loop
elapsed: 40m23s | iter 001100/001133 | nll loss: 7.0189 | 2.6897s per loop
elapsed: 40m46s | iter 001110/001133 | nll loss: 7.3990 | 2.3257s per loop
elapsed: 41m07s | iter 001120/001133 | nll loss: 7.5515 | 2.0562s per loop
elapsed: 41m17s | iter 001130/001133 | nll loss: 7.4415 | 0.9470s per loop
duration of clip (18) does not match specified size
duration of clip (55) does not match specified size
no key 'segments'
no key 'segments'
duration of clip (63) does not match specified size
duration of clip (31) does not match specified size
duration of clip (9) does not match specified size
duration of clip (44) does not match specified size
stacking failed
duration of clip (52) does not match specified size
duration of clip (33) does not match specified size
duration of clip (43) does not match specified size
duration of clip (38) does not match specified size
duration of clip (35) does not match specified size
duration of clip (44) does not match specified size
duration of clip (25) does not match specified size
stacking failed
duration of clip (57) does not match specified size
duration of clip (6) does not match specified size
duration of clip (11) does not match specified size
duration of clip (15) does not match specified size
no key 'segments'
duration of clip (41) does not match specified size
duration of clip (25) does not match specified size
duration of clip (62) does not match specified size
no key 'segments'
duration of clip (54) does not match specified size
duration of clip (25) does not match specified size
duration of clip (33) does not match specified size
duration of clip (1) does not match specified size
duration of clip (59) does not match specified size
duration of clip (58) does not match specified size
duration of clip (53) does not match specified size
duration of clip (31) does not match specified size
duration of clip (48) does not match specified size
duration of clip (59) does not match specified size
no key 'segments'
duration of clip (20) does not match specified size
duration of clip (33) does not match specified size
duration of clip (14) does not match specified size
duration of clip (54) does not match specified size
duration of clip (47) does not match specified size
duration of clip (36) does not match specified size
duration of clip (33) does not match specified size
no key 'segments'
duration of clip (21) does not match specified size
duration of clip (16) does not match specified size
duration of clip (61) does not match specified size
duration of clip (44) does not match specified size
duration of clip (24) does not match specified size
duration of clip (46) does not match specified size
duration of clip (40) does not match specified size
duration of clip (33) does not match specified size
duration of clip (53) does not match specified size
no key 'segments'
duration of clip (52) does not match specified size
duration of clip (50) does not match specified size
no key 'segments'
duration of clip (9) does not match specified size
duration of clip (44) does not match specified size
duration of clip (53) does not match specified size
duration of clip (28) does not match specified size
stacking failed
no key 'segments'
duration of clip (47) does not match specified size
duration of clip (5) does not match specified size
duration of clip (38) does not match specified size
duration of clip (60) does not match specified size
duration of clip (35) does not match specified size
duration of clip (60) does not match specified size
duration of clip (27) does not match specified size
duration of clip (32) does not match specified size
no key 'segments'
duration of clip (50) does not match specified size
duration of clip (43) does not match specified size
duration of clip (22) does not match specified size
no key 'segments'
duration of clip (52) does not match specified size
duration of clip (42) does not match specified size
duration of clip (39) does not match specified size
duration of clip (52) does not match specified size
duration of clip (27) does not match specified size
duration of clip (62) does not match specified size
duration of clip (7) does not match specified size
duration of clip (40) does not match specified size
duration of clip (25) does not match specified size
duration of clip (20) does not match specified size
duration of clip (42) does not match specified size
duration of clip (42) does not match specified size
duration of clip (14) does not match specified size
stacking failed
duration of clip (62) does not match specified size
duration of clip (31) does not match specified size
duration of clip (58) does not match specified size
duration of clip (39) does not match specified size
duration of clip (12) does not match specified size
duration of clip (49) does not match specified size
duration of clip (42) does not match specified size
duration of clip (16) does not match specified size
duration of clip (55) does not match specified size
duration of clip (9) does not match specified size
duration of clip (35) does not match specified size
duration of clip (27) does not match specified size
duration of clip (53) does not match specified size
duration of clip (55) does not match specified size
duration of clip (40) does not match specified size
duration of clip (57) does not match specified size
duration of clip (43) does not match specified size
duration of clip (61) does not match specified size
duration of clip (61) does not match specified size
duration of clip (36) does not match specified size
duration of clip (36) does not match specified size
duration of clip (18) does not match specified size
duration of clip (33) does not match specified size
duration of clip (12) does not match specified size
duration of clip (50) does not match specified size
elapsed: 41m19s, epoch 0001/1000 done, loss: 7.339082
sample sentences:
<BOS>
the the the the the the the a
<BOS> the <BOS> the the a
the <BOS> <BOS> the <BOS>
<BOS> the the the the the the the the
<BOS> <BOS> the the <BOS> the <BOS> the the <BOS> the
<BOS> the <BOS>
<BOS> <BOS> <BOS>
saved encoder model to ../models/resnext_101/b008_s224_l064/ep0001.ckpt
saved decoder model to ../models/Transformer_fine/b008_s224_l064/ep0001.ckpt
elapsed: 42m04s | iter 000010/001133 | nll loss: 7.1540 | 4.2972s per loop
elapsed: 42m29s | iter 000020/001133 | nll loss: 7.0649 | 2.5016s per loop
elapsed: 42m52s | iter 000030/001133 | nll loss: 6.9222 | 2.2905s per loop
elapsed: 43m14s | iter 000040/001133 | nll loss: 7.5528 | 2.2009s per loop
elapsed: 43m39s | iter 000050/001133 | nll loss: 7.2719 | 2.5041s per loop
elapsed: 44m01s | iter 000060/001133 | nll loss: 7.4203 | 2.1933s per loop
elapsed: 44m23s | iter 000070/001133 | nll loss: 7.3195 | 2.2608s per loop
elapsed: 44m48s | iter 000080/001133 | nll loss: 7.6388 | 2.5019s per loop
elapsed: 45m14s | iter 000090/001133 | nll loss: 7.1192 | 2.5738s per loop
elapsed: 45m38s | iter 000100/001133 | nll loss: 7.4798 | 2.3664s per loop
elapsed: 46m02s | iter 000110/001133 | nll loss: 7.6482 | 2.4049s per loop
elapsed: 46m26s | iter 000120/001133 | nll loss: 7.4669 | 2.3726s per loop
elapsed: 46m52s | iter 000130/001133 | nll loss: 7.2341 | 2.6259s per loop
elapsed: 47m14s | iter 000140/001133 | nll loss: 7.0965 | 2.1910s per loop
elapsed: 47m35s | iter 000150/001133 | nll loss: 7.3892 | 2.1439s per loop
elapsed: 48m00s | iter 000160/001133 | nll loss: 7.3915 | 2.4735s per loop
elapsed: 48m26s | iter 000170/001133 | nll loss: 7.4587 | 2.5875s per loop
elapsed: 48m48s | iter 000180/001133 | nll loss: 7.1782 | 2.2294s per loop
elapsed: 49m12s | iter 000190/001133 | nll loss: 6.9491 | 2.3842s per loop
elapsed: 49m34s | iter 000200/001133 | nll loss: 7.4169 | 2.2488s per loop
elapsed: 50m00s | iter 000210/001133 | nll loss: 7.1855 | 2.5556s per loop
elapsed: 50m22s | iter 000220/001133 | nll loss: 7.5376 | 2.1765s per loop
elapsed: 50m45s | iter 000230/001133 | nll loss: 7.2795 | 2.3422s per loop
elapsed: 51m10s | iter 000240/001133 | nll loss: 7.3928 | 2.4485s per loop
elapsed: 51m31s | iter 000250/001133 | nll loss: 7.4941 | 2.1021s per loop
elapsed: 51m53s | iter 000260/001133 | nll loss: 7.1424 | 2.2505s per loop
elapsed: 52m18s | iter 000270/001133 | nll loss: 7.6596 | 2.4703s per loop
elapsed: 52m42s | iter 000280/001133 | nll loss: 7.0768 | 2.4538s per loop
elapsed: 53m04s | iter 000290/001133 | nll loss: 7.3405 | 2.1611s per loop
elapsed: 53m27s | iter 000300/001133 | nll loss: 7.4907 | 2.2923s per loop
elapsed: 53m53s | iter 000310/001133 | nll loss: 7.1958 | 2.5900s per loop
elapsed: 54m14s | iter 000320/001133 | nll loss: 7.3739 | 2.1163s per loop
elapsed: 54m36s | iter 000330/001133 | nll loss: 7.1440 | 2.2325s per loop
elapsed: 55m03s | iter 000340/001133 | nll loss: 7.1321 | 2.6170s per loop
elapsed: 55m26s | iter 000350/001133 | nll loss: 7.1107 | 2.3504s per loop
elapsed: 55m48s | iter 000360/001133 | nll loss: 7.0653 | 2.2383s per loop
elapsed: 56m12s | iter 000370/001133 | nll loss: 7.2539 | 2.3535s per loop
elapsed: 56m33s | iter 000380/001133 | nll loss: 7.2718 | 2.1049s per loop
elapsed: 56m55s | iter 000390/001133 | nll loss: 7.0798 | 2.1730s per loop
elapsed: 57m17s | iter 000400/001133 | nll loss: 6.8826 | 2.2255s per loop
elapsed: 57m42s | iter 000410/001133 | nll loss: 7.3205 | 2.5099s per loop
elapsed: 58m06s | iter 000420/001133 | nll loss: 7.0599 | 2.3937s per loop
elapsed: 58m29s | iter 000430/001133 | nll loss: 7.0321 | 2.2754s per loop
elapsed: 58m49s | iter 000440/001133 | nll loss: 7.2296 | 1.9821s per loop
elapsed: 59m10s | iter 000450/001133 | nll loss: 7.0966 | 2.1854s per loop
elapsed: 59m31s | iter 000460/001133 | nll loss: 7.1768 | 2.0660s per loop
elapsed: 59m54s | iter 000470/001133 | nll loss: 7.3077 | 2.2757s per loop
elapsed: 01h00m16s | iter 000480/001133 | nll loss: 7.1278 | 2.1711s per loop
elapsed: 01h00m35s | iter 000490/001133 | nll loss: 7.0256 | 1.9802s per loop
elapsed: 01h00m58s | iter 000500/001133 | nll loss: 7.1826 | 2.2756s per loop
elapsed: 01h01m19s | iter 000510/001133 | nll loss: 7.2466 | 2.0623s per loop
elapsed: 01h01m42s | iter 000520/001133 | nll loss: 7.4287 | 2.3306s per loop
elapsed: 01h02m02s | iter 000530/001133 | nll loss: 7.1342 | 1.9728s per loop
elapsed: 01h02m27s | iter 000540/001133 | nll loss: 7.1059 | 2.5473s per loop
elapsed: 01h02m49s | iter 000550/001133 | nll loss: 7.0700 | 2.1566s per loop
elapsed: 01h03m12s | iter 000560/001133 | nll loss: 7.0992 | 2.3260s per loop
elapsed: 01h03m35s | iter 000570/001133 | nll loss: 7.2126 | 2.2848s per loop
